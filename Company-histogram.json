{"paragraphs":[{"text":"import org.apache.spark.sql.types.{StructType, StructField, StringType, IntegerType, DoubleType, LongType}\n\nval sqlContext = new org.apache.spark.sql.SQLContext(sc)\nval df = sqlContext.read.json(\"/tmp/companies.json\")\ndf.createOrReplaceTempView(\"company\")\n\nval schema = StructType(Array(\n    StructField(\"Name\",StringType),\n    StructField(\"Year\",LongType)\n))\n\nval selectedDF = df.select(\"name\",\"founded_year\").filter($\"founded_year\" >= 1994).filter($\"founded_year\" <= 2013)\nval companyDF = spark.createDataFrame(selectedDF.rdd, schema)\n","user":"anonymous","dateUpdated":"2017-11-01T23:37:12-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types.{StructType, StructField, StringType, IntegerType, DoubleType, LongType}\nwarning: there was one deprecation warning; re-run with -deprecation for details\nsqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@112a7855\ndf: org.apache.spark.sql.DataFrame = [_id: struct<$oid: string>, acquisition: struct<acquired_day: bigint, acquired_month: bigint ... 7 more fields> ... 40 more fields]\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(Name,StringType,true), StructField(Year,LongType,true))\nselectedDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [name: string, founded_year: bigint]\ncompanyDF: org.apache.spark.sql.DataFrame = [Name: string, Year: bigint]\nstartValues: Array[Double] = Array(1994.0, 1997.8, 2001.6, 2005.4, 2009.2, 2013.0)\ncounts: Array[Long] = Array(658, 1808, 2749, 6862, 146)\nselectedDF: org.apache.spark.sql.DataFrame = [founded_year: bigint, amount: bigint]\nzippedValues: Array[(Double, Long)] = Array((1994.0,658), (1997.8,1808), (2001.6,2749), (2005.4,6862), (2009.2,146))\ndefined class HistRow\nrowRDD: Array[HistRow] = Array(HistRow(1994.0,658), HistRow(1997.8,1808), HistRow(2001.6,2749), HistRow(2005.4,6862), HistRow(2009.2,146))\nhistDf: org.apache.spark.sql.DataFrame = [startPoint: double, count: bigint]\n"}]},"apps":[],"jobName":"paragraph_1509593070104_1338225632","id":"20171101-232430_1973052580","dateCreated":"2017-11-01T23:24:30-0400","dateStarted":"2017-11-01T23:31:52-0400","dateFinished":"2017-11-01T23:32:00-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:201"},{"text":"val (startValues, counts) = companyDF.filter($\"Year\".isNotNull).map(value => value.getLong(1)).rdd.histogram(10)","user":"anonymous","dateUpdated":"2017-11-01T23:37:33-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"startValues: Array[Double] = Array(1994.0, 1995.9, 1997.8, 1999.7, 2001.6, 2003.5, 2005.4, 2007.3, 2009.2, 2011.1, 2013.0)\ncounts: Array[Long] = Array(242, 416, 823, 985, 1036, 1713, 3700, 3162, 103, 43)\n"}]},"apps":[],"jobName":"paragraph_1509593833937_484554835","id":"20171101-233713_1651978928","dateCreated":"2017-11-01T23:37:13-0400","dateStarted":"2017-11-01T23:37:33-0400","dateFinished":"2017-11-01T23:37:35-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:202"},{"text":"\nval zippedValues = startValues.zip(counts)\ncase class HistRow(startPoint:Double,count:Long)\nval rowRDD = zippedValues.map( value => HistRow(value._1,value._2))\nval histDf = spark.createDataFrame(rowRDD)\nhistDf.createOrReplaceTempView(\"histogramTable\")","user":"anonymous","dateUpdated":"2017-11-01T23:37:38-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"zippedValues: Array[(Double, Long)] = Array((1994.0,242), (1995.9,416), (1997.8,823), (1999.7,985), (2001.6,1036), (2003.5,1713), (2005.4,3700), (2007.3,3162), (2009.2,103), (2011.1,43))\ndefined class HistRow\nrowRDD: Array[HistRow] = Array(HistRow(1994.0,242), HistRow(1995.9,416), HistRow(1997.8,823), HistRow(1999.7,985), HistRow(2001.6,1036), HistRow(2003.5,1713), HistRow(2005.4,3700), HistRow(2007.3,3162), HistRow(2009.2,103), HistRow(2011.1,43))\nhistDf: org.apache.spark.sql.DataFrame = [startPoint: double, count: bigint]\n"}]},"apps":[],"jobName":"paragraph_1509593792748_-1057195305","id":"20171101-233632_1126830807","dateCreated":"2017-11-01T23:36:32-0400","dateStarted":"2017-11-01T23:37:38-0400","dateFinished":"2017-11-01T23:37:40-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:203"},{"text":"%sql\nselect * from histogramTable","user":"anonymous","dateUpdated":"2017-11-01T23:39:59-0400","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"startPoint","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"startPoint\tcount\n1994.0\t242\n1995.9\t416\n1997.8\t823\n1999.7\t985\n2001.6\t1036\n2003.5\t1713\n2005.4\t3700\n2007.3\t3162\n2009.2\t103\n2011.1\t43\n"}]},"apps":[],"jobName":"paragraph_1509593160671_39636798","id":"20171101-232600_598228589","dateCreated":"2017-11-01T23:26:00-0400","dateStarted":"2017-11-01T23:39:08-0400","dateFinished":"2017-11-01T23:39:08-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:204"},{"text":"%sql\n","user":"anonymous","dateUpdated":"2017-11-01T23:35:33-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1509593733735_1618825241","id":"20171101-233533_17544324","dateCreated":"2017-11-01T23:35:33-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:205"}],"name":"Company","id":"2CWDS272D","angularObjects":{"2CWFRK63H:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}